% !TeX root =./x2.tex
% !TeX program = pdfpLaTeX

\newcommand{\ZU}{\marginpar{図を挿入}}


\chapter{準備}
\section{Known}
$K$, 体

\section{Intoroduction}
Quiver の表現の直既約分解に関する諸々について解説することが目標である.

\subsection{Quiver (矢筒, 箙(えびら))とは?}
(ラベルのついた)点(頂点)と,
それらを結ぶ(ラベルのついた)矢印(辺)
を集めたもの(図形)をQuiverと呼ぶ.
\begin{example}
  \ZU
  \begin{align*}
    \bullet_{1} \xrightarrow{\alpha} \bullet_{2}
  \end{align*}
\end{example}
\begin{example}
  \ZU
  \begin{align*}
    \bullet_{1} 
  \end{align*}
\end{example}
\begin{example}
  \ZU
  \begin{align*}
    \bullet_{1}
    \genfrac{}{}{0pt}{}{\xrightarrow{\alpha}}{\xrightarrow{\beta}}
    \bullet_{2}
  \end{align*}
\end{example}
\begin{example}
  \ZU
  \begin{align*}
    \genfrac{}{}{0pt}{}{\bullet_{1}}{\circlearrowleft_{\alpha}}
  \end{align*}
\end{example}

集合と写像の言葉で定義するなら,
\begin{enumerate}
\item $Q_0$: 集合 (頂点の集合)
\item $Q_1$: 集合 (辺(矢印)の集合)
\item $s\colon Q_1\to Q_0$: 写像. ($s(\alpha)$は辺$\alpha$の始点\footnote{start, source})
\item $t\colon Q_1\to Q_0$: 写像. ($t(\alpha)$は辺$\alpha$の終点\footnote{teminal, target})
\end{enumerate}
の4つのデータの組$(Q_0,Q_1,s,t)$がQuiver.
(多重辺, セルフループを許す有向グラフという言い方もする)


\begin{example}
  \ZU
  $Q_0=\Set{1,2,3}$,
  $Q_1=\Set{\alpha,\beta,\gamma,\delta}$,
  $s(\alpha)=1$,
  $t(\alpha)=2$,
  $s(\beta)=1$,
  $t(\beta)=2$,
  $s(\gamma)=2$,
  $t(\gamma)=1$,
  $s(\delta)=1$,
  $t(\delta)=1$
  は次の図で表されるものとなる.
\end{example}



\subsection{quiverの表現とは?}
$Q=(Q_0,Q_1,s,t)$をquiverとする.
\begin{enumerate}
\item
  $x\in Q_0$に対し,
  ($K$-)線型空間(有限次元ベクトル空間, 有限生成加群)$V_x$,
\item
  $\alpha\in Q_1$に対し,
  ($K$-)線型写像$f_\alpha\colon V_{s(\alpha)} \to V_{t(\alpha)}$
  が対応しているとき,
  その対応$(V_\bullet,f_\bullet)$を$Q$び
  ($K$-線型空間のカテゴリーへの)表現と呼ぶ.
\end{enumerate}

\begin{example}
  \ZU
  $Q_0=\Set{1}$,
  $Q_1=\Set{\alpha}$,
  $s(\alpha)=1$,
  $t(\alpha)=1$
  とする.
  このとき,
  例えば,
  \begin{align*}
    V_1=\CC^2&\\
    f_\alpha\colon V_1&\to V_1\\
    \begin{pmatrix}a\\b\end{pmatrix}
      &\mapsto
    \begin{pmatrix}b\\a\end{pmatrix}
  \end{align*}
  とすれば,
  $(V_\bullet,f_\bullet)$は$Q$の表現である.
  例えば,
  \begin{align*}
    V_1=\CC^2&\\
    f'_\alpha\colon V_1&\to V_1\\
    \begin{pmatrix}a\\b\end{pmatrix}
      &\mapsto
    \begin{pmatrix}a\\0\end{pmatrix}
  \end{align*}
  とすれば,
  $(V_\bullet,f'_\bullet)$は$Q$の表現である.
\end{example}

\begin{example}
  \ZU
  $Q_0=\Set{1,2}$,
  $Q_1=\Set{\alpha}$,
  $s(\alpha)=1$,
  $t(\alpha)=2$
  とする.
  このとき,
  例えば,
  \begin{align*}
    V_1=\CC^2&\\
    V_2=\CC^2&\\
    f_\alpha\colon V_1&\to V_2\\
    \begin{pmatrix}a\\b\end{pmatrix}
      &\mapsto
    \begin{pmatrix}b\\a\end{pmatrix}
  \end{align*}
  とすれば,
  $(V_\bullet,f_\bullet)$は$Q$の表現である.
  例えば,
  \begin{align*}
    V_1=\CC^2&\\
    V_2=\CC^2&\\
    f'_\alpha\colon V_1&\to V_2\\
    \begin{pmatrix}a\\b\end{pmatrix}
      &\mapsto
    \begin{pmatrix}a\\0\end{pmatrix}
  \end{align*}
  とすれば,
  $(V_\bullet,f'_\bullet)$は$Q$の表現である.
\end{example}

\begin{example}
  \ZU
  $Q_0=\Set{1,2}$,
  $Q_1=\Set{\alpha,\beta}$,
  $s(\alpha)=s(\beta)=1$,
  $t(\alpha)=t(\alpha)=2$
  とする.
  このとき,
  例えば,
  \begin{align*}
    V_1=\CC^2&\\
    V_2=\CC^2&\\
    f_\alpha\colon V_1&\to V_2\\
    \begin{pmatrix}a\\b\end{pmatrix}
      &\mapsto
    \begin{pmatrix}a\\0\end{pmatrix}\\
    f_\beta\colon V_1&\to V_2\\
    \begin{pmatrix}a\\b\end{pmatrix}
      &\mapsto
    \begin{pmatrix}0\\b\end{pmatrix}
  \end{align*}
  とすれば,
  $(V_\bullet,f_\bullet)$は$Q$の表現である.
\end{example}

\begin{example}
  $Q=(Q_0,Q_1,s,t)$をquiverとする.
  このとき,
  \begin{enumerate}
  \item 各$x\in Q_0$に対して, $V_x=\Set{0}$ ($0$)
  \item 各$\alpha\in Q_1$に対して,
    \begin{align*}
      f_\alpha = \underline{0} \colon \Set{0} &\to \Set{0}\\
      0&\mapsto 0
    \end{align*}
  \end{enumerate}
  とすると
  $(V_\bullet,f_\bullet)$は$Q$の表現である.
  これを零表現と呼ぶ.
\end{example}

\begin{example}
  $Q=(Q_0,Q_1,s,t)$をquiverとする.
  $(V_\bullet, f_\bullet)$,
  $(U_\bullet, g_\bullet)$
  を$Q$の表現とする.
  \begin{enumerate}
  \item
    $x\in Q_0$に対し,
    $W_\bullet=V_x\oplus U_x$
  \item
    $\alpha\in Q_1$に対し, 
    \begin{align*}
      h_\alpha = f_\alpha\oplus g_\alpha \colon
      V_{s(\alpha)}\oplus U_{s(\alpha)}&\to
      V_{t(\alpha)}\oplus U_{t(\alpha)}
      \\
      (v,u)&\mapsto (f_\alpha(v),g_\alpha(u))
    \end{align*}
  \end{enumerate}
    とおくと,
    $(W_\bullet,h_\bullet)$は$Q$の表現である.
    これを,
    $(V_\bullet, f_\bullet)$と
    $(U_\bullet, g_\bullet)$の
    直和とよび,
    $(V_\bullet, f_\bullet)\oplus (U_\bullet, g_\bullet)$
    で表す.
  \end{example}

\subsection{Quiverの表現の構造について}

$Q$をquiverとする.
$Q$の表現$(V_\bullet,f_\bullet)$を理解するにはどうしたらよいか?

一つの答え:
より``小さい''表現に分解する.
\begin{align*}
  (V_\bullet,f_\bullet)=
  (V'_\bullet,f'_\bullet)\oplus (V''_\bullet,f''_\bullet)
\end{align*}
みたいに直和に分解していく.
$\dim(V'_x),\dim(V''_x)\leq\dim(V_x)$
なのだから, $V'_x$, $V''_x$の方が簡単に違いない.
分解を頑張ってこれ以上分解できないところまで分解して,
\begin{align*}
(V_\bullet,f_\bullet)=
  (V^{(1)}_\bullet,f^{(1)}_\bullet)\oplus (V^{(2)}_\bullet,f^{(2)}_\bullet)
  \oplus \cdots
\end{align*}
と書けたら,
`これ以上分解できない表現達' (直既約表現)
がわかっていれば,
$(V_\bullet,f_\bullet)$
はわかったことになるはず.
(直既約表現の方が$(V_\bullet,f_\bullet)$よりも簡単なはず.)

問題:
\begin{enumerate}
\item
  \label{basicquestion:ks}
  表現は直既約表現の直和として書けるのか?
\item
  \label{basicquestion:ar}
  与えられた直既約表現の直和に分解する方法(アルゴリズム)?
\item
  \label{basicquestion:gt}
  $Q$の直既約表現は何種類くらいあるのか?
  有限個/無限個?
\end{enumerate}

\Cref{basicquestion:ks}について:
Krull-Schimidtの定理 ($\CC$上ならOK)

\Cref{basicquestion:ar}について:
(非アルゴリズム的\footnote{無限回のステップからなる手続きを含む}な)
一般論としてはAuslander--Reiten理論が知られている.
アルゴリズム的な方法は一部のQuiverに対して与えられている.
(行列の行基本変形の延長)

\Cref{basicquestion:gt}について:
Gabrielの定理.
次は同値:
\begin{enumerate}
\item
  $Q$の直既約表現が有限種類しかない.
\item
  $Q$は(simply laced) Dynkin図形に向きをつけたものののみ.
\end{enumerate}
ただし, (simply laced) Dynkin図形とは,
\ZU
$A_n$, $D_n$, $E_n$
のこと.


実は, \ZU
\begin{itemize}
\item
  $Q=\genfrac{}{}{0pt}{}{\bullet}{\circlearrowleft}$のときには,
  $Q$の表現の直既約分解はジョルダン標準形を求めることに相当する.
\item
  $Q=\bullet\to\bullet$のときには,
  $Q$の表現の直既約分解はランク標準形(スミス標準形)($\begin{pmatrix}E&O\\O&O\end{pmatrix}$)を求めることに相当する.
\end{itemize}
これらについては前半で復習する.


\subsection{$A_n$型quiverの表現と関連する話}
\subsubsection{$A_n$型quiverの表現について}
\begin{align*}
Q=\bullet_1\xrightarrow{\alpha_1}\bullet_2\xrightarrow{\alpha_2}\bullet_3\cdots \bullet_{n-1}\xrightarrow{\alpha_{n-1}}\bullet_n
\end{align*}
について考える.
$1\leq i\leq j\leq n$に対し,
区間表現$I[i,j]=(V_\bullet,f_\bullet)$を次で定める:
\begin{enumerate}
\item
  $x\in Q_0$に対し,
  \begin{align*}
    V_x=
    \begin{cases}
      \CC & (i\leq x \leq j)\\
      \Set{0} & (\text{otherwise}).
    \end{cases}
  \end{align*}
\item
  $\alpha_k\in Q_1$に対し,
  \begin{align*}
    f_{\alpha_k}=
    \begin{cases}
      \underline{0}\colon\Set{0} \to \Set{0} & (1\leq k < i-1)\\
      \underline{0}\colon\Set{0} \to \CC & (k=i-1)\\
      \id_\CC\colon\CC \to \CC & (i\leq k < j)\\
      \underline{0}\colon\CC \to \Set{0} & (k=j)\\
      \underline{0}\colon\Set{0} \to \Set{0} & (j+1\leq k).
    \end{cases}
  \end{align*}  
\end{enumerate}
つまり,
\begin{align*}
  I[i,j]\colon
  0\xrightarrow{\underline{0}}
  0\xrightarrow{\underline{0}} \cdots \xrightarrow{\underline{0}}
  0\xrightarrow{\underline{0}}
  \underbrace{\CC}_{i} \xrightarrow{\id_\CC}
  \CC \xrightarrow{\id_\CC} \cdots
  \underbrace{\CC}_{j} \xrightarrow{\underline{0}}
  0\xrightarrow{\underline{0}}
  0\xrightarrow{\underline{0}} \cdots \xrightarrow{\underline{0}}
  0.
\end{align*}
実は,
$Q$の既約表現は, $I[i,j]$ ($1\leq i\leq j \leq n$)で
(同型を除き)全部であることが知られている.
つまり, $Q$の表現$(V_\bullet,f_\bullet)$は,
\begin{align*}
  (V_\bullet,f_\bullet)
  &=I[i_1,j_1]\oplus\cdots\oplus I[i_N,j_N]
\end{align*}
という形で書ける.

\subsubsection{Persistent Homology}
ホモロジー:
幾何的対象 $\leadsto$ ホモロジー群
\ZU
`穴の個数'を調べる道具.



時刻$t$に合わせて変化する図形$X_t$を考える.
\begin{example}
  \label{ex:fundex:ph}
\ZU
中心は動かず時刻に合わせて
半径が大きくなる円たち.
\end{example}

各時刻でのホモロジー$H(X_t)$が得られる.
つまり時刻$t$に合わせて変化するホモロジー群(ベクトル空間)
$\leadsto$ パーシステントホモロジー.

\Cref{ex:fundex:ph}の様に
\begin{align*}
  t\leq t' \implies X_t \subset X_{t'}
\end{align*}
という条件をみたいしていたら,
\begin{align*}
  X_t&\injectto X_{t'}\\
  x&\mapsto x
\end{align*}
から, 線型写像
\begin{align*}
  H(X_{t'})&\to H(X_t)\\
\end{align*}
を作ることができる,
よって,
$t_1<\cdots <t_n$を取ると,
\begin{align*}
  H(X_1)\to H(X_2)\to\cdots
\end{align*}
という$A_n$型の表現が得られる.
この表現の直既約分解
\begin{align*}
  I[i_1,j_1]\oplus \cdots\oplus I[i_N,j_N]
\end{align*}
を考える.
$I[i_k,j_k]$に含まれるホモロジー類は,
時刻$i_k$に現れ時刻$j_k$に消えることをがわる.
標語的な言い方をすると,
`時刻$i_k$で生まれ
時刻$j_k$で消える
``穴''がある'
ことを意味している.
したがって,
`穴' の個数だけでなく,
その生存時刻(大きさ)がわかる.

$\leadsto$
\begin{itemize}
\item
  この情報を使ってデータ解析をするというのが流行っている.
\item
  例えば, $t$だけではなく,
  2つのパラメータ$(t,s)$などで変化する図形のときには,
  別のQuiverの表現.
\end{itemize}


\subsubsection{Leschets性}
多項式環$A=K[x_1,\ldots,x_n]$を考える.
$f\in A$ 
に現れる単項式が$k$次のもののみであるとき,
$f$は$k$次斉次多項式であるという.
$A_k$で$k$次斉次多項式を集めた集合とする.
(ただし, $0\in A_k$と約束する.)

$f_1,\ldots, f_n\in A$
とし, いずれも斉次多項式であるとする.
$I$を$f_1,\ldots, f_n$で生成されるイデアルとする.
つまり
$I=\Braket{f_1,\ldots,f_m}_{A}$
とする.
剰余環
$R=A/I$
について考える.
$R_k=\Set{\overline{f}\in R|f\in A_k}$
とおくと,
$R_i$は$K$-線型空間であり,
$R=\bigoplus_{k=0}^{infty}A_k$
と書ける.
一般には$R$は無限次元の$K$-線型空間であるが,
ここでは,
アルチン環であることを仮定し,
$R=\bigoplus_{k=0}^{s}A_k$, $A_s\neq \Set{0}$
と書けるとする.

$\overline{l}\in R_1$とする.
このとき,
\begin{align*}
  \times \overline{l}\colon
R_{k}&\to R_{k+1}  \\
\overline{f}&\mapsto \overline{fl}
\end{align*}
は$K$-線型写像であり,
\begin{align*}
  R_0\xrightarrow{\times\overline{l}}
  R_1\xrightarrow{\times\overline{l}}
  R_1\xrightarrow{\times\overline{l}}\cdots
\end{align*}
という表現が得られる.
この表現の直既約分解
\begin{align*}
  I[i_1,j_1]\oplus \cdots\oplus I[i_N,j_N]
\end{align*}
として,
\begin{align*}
  i_1\leq i_2 \leq \cdots\leq i_N \leq j_N \leq j_{N-1} \leq \cdots \leq j_1
\end{align*}
となっているとき,
$\overline{l}$は$R$の広義Lefschetz元と呼ぶ.

Lefschetz元を持つ環は,
コホモロジー環
などと言った面白い環であることが多い.

与えられた環がLefschetz元を持つか?
もしもつなら, Lefschetz元は何か?
という問題を考えることができる.

\section{今後の予定}
\begin{enumerate}
\item 線型代数の復習---行列の標準形 (証明はせず事実のみを紹介する)
  \begin{enumerate}
  \item 行基本変形
  \item 対角化
  \item Jordan標準形
  \end{enumerate}
\item Quiverの表現に関する概説---直既約表現
  \begin{enumerate}
  \item 定義
  \item $\bullet \to \bullet$の表現
  \item $\genfrac{}{}{0pt}{}{\bullet}{\circlearrowleft}$の表現
  \item finite type/infinite fype
  \end{enumerate}
\item
  関連する話題.
  \begin{enumerate}
  \item パーシステントホモロジー
  \item Lefschetz性
  \end{enumerate}
\end{enumerate}

目標は
\begin{enumerate}
\item 行列の対角化とかができる.
\item Quiverという言葉を知っている.
\end{enumerate}
ARはやらない.

\tableofcontents
\chapter{行列についての復習}
\section{行列の用語と記号}
  %% $I$, $J$を有限集合とする.
  %% 各$i\in I$, $j\in J$に対し
  %% $a_{i,j}$が定まっているとき,
  %% $(a_{i,j})_{i\in I,j\in J}$
  %% のように書き,
  %% $(a_{i,j})_{i\in I,j\in J}$を
  %% $(I,J)$-行列と呼ぶ
  %% $(I,J)$-行列
  %% $(a_{i,j})_{i\in I,j\in J}$に対し,
  %% $I$を行のindex,
  %% $J$を列のindexと呼ぶ.
  %% つまり,
  %% $(\quad)_{i\in I,j\in J}$の様に,
  %% カッコの外側に書かれている部分で,
  %% 最初に指定されている集合が行のindexであり,
  %% 最後に指定されている集合が列のindexである. 
  
  %% 通常は,　
  %% $I=\Set{1,\ldots,m}$,
  %% $J=\Set{1,\ldots,n}$
  %% というような集合を考える.
  %% 正の整数は通常の大小関係で全順序となっているので,
  %% その順序に従い表の様に,
  %% \begin{align*}
  %%   \begin{pmatrix}
  %%     a_{1,1}&a_{1,2}&\cdots &a_{1,n}\\
  %%     a_{2,1}&a_{2,2}&\cdots &a_{2,n}\\
  %%     \vdots&\vdots &&\vdots\\
  %%     a_{m,1}&a_{m,2}&\cdots &a_{m,n}
  %%   \end{pmatrix}
  %% \end{align*}
  %% の様に書くことで行列を表すこともある.

  %% $(a_{i,j})_{i\in I,j\in I}$
  %% という行列を正方行列と呼ぶ.
  %% つまり,
  %% 行のindexと列のindexが`同じ'ときに正方行列と呼ぶ.
$K$を体とする.
また, $K^\times=\Set{x\in K|x\neq 0}$とする.

$i\in\Set{1,\ldots,m}$,
$j\in\Set{1,\ldots,n}$
に対し,
$a_{i,j}\in K$
が与えられているとする.
このとき,
\begin{align*}
    \begin{pmatrix}
      a_{1,1}&a_{1,2}&\cdots &a_{1,n}\\
      a_{2,1}&a_{2,2}&\cdots &a_{2,n}\\
      \vdots&\vdots &&\vdots\\
      a_{m,1}&a_{m,2}&\cdots &a_{m,n}
    \end{pmatrix}
\end{align*}
のように$a_{i,j}$を並べたものを$(m,n)$行列と呼ぶ.
\begin{align*}
  (a_{i,j})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}
\end{align*}
のように表すこともある.
この表記では,
$(\quad)_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}$
のカッコの外側にある添字に添字の情報が書かれている.
上段が, 行を表す添字は$i$であり$1,\ldots,m$の値を取りうることを
表している.
下段が, 列を表す添字は$j$であり$1,\ldots,n$の値を取りうることを
表している.

$(m,n)$-行列$A$,
$(m,l)$-行列$B$
を
並べて作った$(m,n+l)$-行列を
\begin{align*}(A|B)\end{align*}
で表す.

$(m,n)$-行列$A$,
$(l,n)$-行列$B$
を
並べて作った$(m,n+l)$-行列を
\begin{align*}
  \begin{pmatrix}A\\\hline B\end{pmatrix}\end{align*}
で表す.

$(n,1)$-行列
\begin{align*}
  \aaa=
  \begin{pmatrix}a_1
  \\\vdots\\a_n
  \end{pmatrix}
\end{align*}
を$n$-項列ベクトルと呼ぶ.

$(1,n)$-行列
\begin{align*}
  \aaa=
  \begin{pmatrix}a_1
  &\cdots&a_n
  \end{pmatrix}
\end{align*}
を$n$-項行ベクトルと呼ぶ.

$(m,n)$-行列を
$m$-項列ベクトルを並べたものとして表したもの
\begin{align*}
  A=\begin{pmatrix}\aaa_1|\aaa_2|\cdots|\aaa_n\end{pmatrix}
\end{align*}
を列ベクトル表示と呼ぶ.


$(m,n)$-行列を
$n$-項行ベクトルを並べたものとして表したもの
\begin{align*}
  A=\begin{pmatrix}\aaa_1\\\hline \aaa_2\\\hline\vdots\\\hline\aaa_n\end{pmatrix}
\end{align*}
を行ベクトル表示と呼ぶ.

\begin{align*}
  \delta_{i,j}=
  \begin{cases}
    1&(i=j)\\
    0&(i\neq j)
  \end{cases}
\end{align*}
とおきKronecker's deltaと呼ぶ.

$(k,l)$-成分のみ1で他は0である$(m,n)$-行列を行列単位と呼び
\begin{align*}
  B_{m,n;k,l}
  &=(\delta_{i,k}\delta_{j,l})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}\\
\end{align*}
とおく.

\begin{align*}
  \ee^{(n)}_j
  &=B_{n,1;j,1}\\
  &=\begin{pmatrix}
  0\\\vdots\\0\\1\\0\\\vdots\\0
  \end{pmatrix}
\end{align*}
とおき, $n$-項基本ベクトルと呼ぶ.

\begin{align*}
  O_{m,n}&=(0)_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}\\
  &=
  \begin{pmatrix}
    0&\cdots&0\\
    \vdots&&\vdots\\
    0&\cdots&0
  \end{pmatrix}
\end{align*}
とおき,
零行列と呼ぶ.


\begin{align*}
  \diag(a_1,\ldots,a_n)
  &=(a_i\delta_{i,j})_{\substack{i=1,\ldots,n\\j=1,\ldots,n}}\\
  &=\begin{pmatrix}a_1\ee^{(n)}_1|\cdots|a_n\ee^{(n)}_n\end{pmatrix}\\
  &=\begin{pmatrix}
  a_1&&0\\
  &\ddots&\\
  0&&a_n
  \end{pmatrix}
\end{align*}
とおき,
($a_1,\ldots,a_n$を対角成分とする)対角行列と呼ぶ.

\begin{align*}
  E_n&=
  \diag(\underbrace{1,\ldots,1}_{n})\\
  &=(\delta_{i,j})_{\substack{i=1,\ldots,n\\j=1,\ldots,n}}\\
  &=\begin{pmatrix}\ee^{(n)}_1|\cdots|\ee^{(n)}_n\end{pmatrix}\\
  &=\begin{pmatrix}
  1&&0\\
  &\ddots&\\
  0&&1
  \end{pmatrix}
\end{align*}
とおき,
単位行列と呼ぶ.



$A_1,\ldots,A_n$を正方行列とする.
\begin{align*}
  A_1\oplus\cdots\oplus A_n
  &=\Diag(A_1,\ldots,A_n)\\
  &=
  \left(
  \begin{array}{c|c|c|c}
    A_1&&&\\\hline
    &A_2&&\\\hline
    &&\ddots&\\\hline
    &&&A_n
    \end{array}
  \right)
\end{align*}
とおき,
ブロック対角行列と呼ぶ.


$A=(a_{i,j})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}$
に対し,
$\transposed{A}=(a_{j,i})_{\substack{i=1,\ldots,n\\j=1,\ldots,m}}$
とおき,
$A$の転置と呼ぶ.
\begin{remark}
  $\transposed{(AB)}=\transposed{B}\transposed{A}$.
\end{remark}

\begin{definition}
  以下の条件を満たすとき,
  $B$が$A$の逆行列であるという:
  \begin{enumerate}
  \item $BA=E_n$.
  \item $AB=E_n$.
  \end{enumerate}
  $A$の逆行列が存在するとき,
  $A$は正則であるという.
\end{definition}
\begin{remark}
  正則行列$A$に対し,
  その逆行列はただ一つである.
  そこで, $A$の逆行列を$A^{-1}$と書く.
\end{remark}
\begin{remark}
  $A$と$B$がともに正則であるとき,
  $AB$も正則であり,
  $(AB)^{-1}=B^{-1}A^{-1}$である.
\end{remark}
\begin{definition}
  $n$次正方行列
  $A=(a_{i,j})_{\substack{i=1,\ldots,n\\j=1,\ldots,n}}$
  について考え,
  $A$の$1$行目と$j$列目を忘れて得られる$(n-1)$次正方行列を
  $A^{(1,j)}$とおく.
  \begin{align*}
    \det(A)=
    \begin{cases}
      \sum_{1=1}^n (-1)^{j+1}a_{1,j}\det (A^{(1,j)})& (n\leq 1)\\
      1& (n=0)
    \end{cases}
  \end{align*}
  と定義し, $\det(A)$を$A$の行列式と呼ぶ.
\end{definition}

\begin{remark}
  $A$が正則であることと$\det(A)$が逆数をもつことは同値である.
\end{remark}

\begin{remark}
  $n$次正方行列$A$, $B$と$\alpha\in K$に対し,
  \begin{align*}
    \det(AB)&=\det(A)\det(B)\\
    \det(\alpha A)&=\alpha^n\det(A).
  \end{align*}
\end{remark}

\begin{definition}
  $n$次正方行列
  $A=(a_{i,j})_{\substack{i=1,\ldots,n\\j=1,\ldots,n}}$
  に対し,
  \begin{align*}
    \tr(A)=a_{1,1}+a_{2,2}+\cdots+a_{n,n}
  \end{align*}
  と定義し, $\tr(A)$を$A$のトレースと呼ぶ.
\end{definition}
\begin{remark}
  $n$次正方行列$A$, $B$と$\alpha\in K$に対し,
  \begin{align*}
    \tr(A+B)&=\tr(A)+\tr(B),\\
    \tr(\alpha A)&=\alpha\tr(A),\\
    \tr(AB)&=\tr(BA).
  \end{align*}
\end{remark}

\section{基本変形と標準形}
\begin{definition}
  $A=(a_{i,j})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}$
  を$(m,n)$-行列とする.
  $i\in\Set{1,\ldots,m}$に対し,
  \begin{align*}
    p_i&=\min\Set{j|a_{i,j}\neq 0} \cup \Set{\infty}
  \end{align*}
  とおく.
  $p_i\neq \infty$のとき,
  $(i,p_i)$を$A$の$i$行目のピボットと呼ぶことにする.

  次の条件を満たすとき, $A$は行階段行列であるという:
  \begin{enumerate}
  \item $p_1<p_2<\cdots<p_n$.
      (ただし, $\infty<\infty$とする.)
  \end{enumerate}
  次の条件を満たすとき, $A$は被約行階段行列であるという:
  \begin{enumerate}
  \item $A$は行階段行列.
  \item $p_i\neq \infty\implies$ $p_i$列目は, $i$行目は$1$, それ以外は$0$.
  \end{enumerate}
\end{definition}
\begin{definition}
  $A=(a_{i,j})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}$
  を$(m,n)$-行列とする.
  
  $\transposed{A}$が行階段行列であるとき,
  $A$は列階段行列であるという.

  $\transposed{A}$が被約行階段行列であるとき,
  $A$は被約列階段行列であるという.
\end{definition}

\begin{definition}
  \begin{align*}
    \left(
    \begin{array}{c|c}
      E_r&O_{r,n-r}\\
      O_{m-r,r}&O_{m-r,n-r}
    \end{array}
    \right)
  \end{align*}
  という$(m,n)$行列を階数$r$の階数標準形と呼ぶ.
\end{definition}
\begin{remark}
  階数$r$の階数標準形は,
  被約行階段行列でもあり,
  被約列階段行列でもある.
\end{remark}

\begin{definition}
  $n$次正方行列$F_n(i;c)$, $G_n(i,j;c)$, $H_n(i,j)$を以下で定義する:
  \begin{enumerate}
    \item $i\in\Set{1,\ldots,n}$, $c\in K^\times$に対し,
      \begin{align*}
        F_n(i;c)&=E_n+(c-1)B_{n,n}(i,i)\\
        &=\diag(1,\ldots,1,\underbrace{c}_{i},1,\ldots,1).
      \end{align*}
    \item $i,j\in\Set{1,\ldots,n}$, $i\neq j$, $c\in K$に対し,
      \begin{align*}
        G_n(i,j;c)&=E_n+cB_{n,n}(i,j).
      \end{align*}
    \item $i,j\in\Set{1,\ldots,n}$, $i\neq j$に対し,
      \begin{align*}
        H_n(i,j)&=E_n+B_{n,n}(i,j)+B_{n,n}(j,i)-B_{n,n}(i,i)-B_{n,n}(j,j).
      \end{align*}
  \end{enumerate}
  これらを($K$上の)基本行列と呼ぶ.
\end{definition}

\begin{prop}
  基本行列は正則であり,
  \begin{align*}
    F_n(i;c)^{-1}&=F_n(i;c^{-1}),\\
    G_n(i,j;c)^{-1}&=G_n(i,j;-c),\\
    H_n(i,j)^{-1}&=H_n(i,j).
  \end{align*}
\end{prop}

\begin{prop}
  基本行列の転置も基本行列であり
  \begin{align*}
    \transposed{F_n(i;c)}&=F_n(i;c),\\
    \transposed{G_n(i,j;c)}&=G_n(j,i;c),\\
    \transposed{H_n(i,j)}&=H_n(i,j).
  \end{align*}
\end{prop}

\begin{prop}
  \label{prop:rowtranformation}
  $A$を$(n,l)$行列とする.
  \begin{enumerate}
  \item $F_n(i;c)A$は``$A$の$i$行目を$c$倍して''得られる行列.
  \item  $G_n(i,j;c)A$は``$A$の$i$行目に$j$行目の$c$倍を加えて''得られる行列.
  \item $H_n(i,j)A$は``$A$の$i$行目と$j$行目を入れ替えて''得られる行列.
  \end{enumerate}
\end{prop}
\begin{remark}
  \Cref{prop:rowtranformation}の操作は行基本変形と呼ばれる.
\end{remark}


\begin{prop}
  \label{prop:coltranformation}
  $A$を$(m,n)$行列とする.
  \begin{enumerate}
  \item $AF_n(i;c)$は``$A$の$i$列目を$c$倍して''得られる行列.
  \item  $AG_n(i,j;c)$は``$A$の$j$列目に$i$列目の$c$倍を加えて''得られる行列.
  \item $AH_n(i,j)$は``$A$の$i$列目と$j$列目を入れ替えて''得られる行列.
  \end{enumerate}
\end{prop}
\begin{remark}
  \Cref{prop:coltranformation}の操作は列基本変形と呼ばれる.
\end{remark}


\begin{prop}
  $A$を$(m,n)$-行列とする.
  $A$に($0$回以上, 有限回の)行基本変形を行うことで,
  被約行階段行列に変形できる.
\end{prop}

\begin{prop}
  $A$を$(m,n)$-行列とする.
  次の条件を満たす$m$次正則行列$P$が存在する:
  \begin{enumerate}
    \item $PA$は被約行階段行列.
  \end{enumerate}
\end{prop}

\begin{prop}
  $A$を$(m,n)$-行列とする.
  $P$, $P'$は$m$次正則行列でり,
  $PA$, $P'A$は被約行階段行列であるとする.
  このとき, $PA=P'A$.
\end{prop}

\begin{prop}
  $A$を$(m,n)$-行列とする.
  $A$に($0$回以上, 有限回の)列基本変形を行うことで,
  被約行階段行列に変形できる.
\end{prop}

\begin{prop}
  $A$を$(m,n)$-行列とする.
  次の条件を満たす$n$次正則行列$P$が存在する:
  \begin{enumerate}
    \item $AP$は被約列階段行列.
  \end{enumerate}
\end{prop}

\begin{prop}
  $A$を$(m,n)$-行列とする.
  $P$, $P'$は$n$次正則行列でり,
  $AP$, $AP'$は被約列階段行列であるとする.
  このとき, $AP=AP'$.
\end{prop}

\begin{prop}
  $A$を$(m,n)$-行列とする.
  $A$に($0$回以上, 有限回の)行基本変形と列基本変形を行うことで,
  階数標準形に変形できる.
\end{prop}
\begin{definition}
  $A$を$(m,n)$-行列とする.
  $A$に($0$回以上, 有限回の)行基本変形と列基本変形を行うことで,
  階数$r$の階数標準形に変形できるとき,
  $A$の階数は$r$であるといい,
  $\rank(A)=r$と書く.
\end{definition}

\begin{remark}
  $(m,n)$-行列全体を考える.
  \begin{enumerate}
  \item
    行基本変形で移り合う行列を`同じ'と思う同値関係を考える.
    つまり正則行列$P$に対して$PA\sim A$とする.
    このとき, 被約行階段行列全体は完全代表系になっている.
  \item
    列基本変形で移り合う行列を`同じ'と思う同値関係を考える.
    つまり正則行列$Q$に対して$AQ\sim A$とする.
    このとき, 被約列階段行列全体は完全代表系になっている.
   \item
    行基本変形と列基本変形で移り合う行列を`同じ'と思う同値関係を考える.
    つまり正則行列$P$, $Q$に対して$PAQ\sim A$とする.
    このとき, 階数標準形全体は完全代表系になっている.
  \end{enumerate}
\end{remark}

\section{連立一次方程式}
$A$を$(m,n)$-行列とし, $\zzero=O_{m,1}$とする.
$n$個の未知数
\begin{align*}
  \xx=\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}
\end{align*}
に関する方程式
\begin{align*}
  A\xx=\zzero
\end{align*}
を斉次連立一次方程式と呼んだ.
この方程式の解の集合を$\KKK(A)$と書くことにする.
つまり,
\begin{align*}
  \KKK(A)=\Set{\vv|A\vv=\zzero}
\end{align*}
である.
\begin{prop}
  $(m,n)$-行列$A$に対し,
  $\KKK(A)$はベクトル空間であり,
  $\dim(\KKK(A))=n-\rank(A)$.
\end{prop}
\begin{cor}
  $n$-次正方行列$A$に対し,
  以下は同値:
  \begin{enumerate}
  \item $\KKK(A)=\Set{\zzero}$.
  \item $\dim(\KKK(A))=0$.
  \item $\rank(A)= n$.
  \item $\det(A)\neq 0$.
  \end{enumerate}
\end{cor}

\begin{cor}
  $n$-次正方行列$A$に対し,
  以下は同値:
  \begin{enumerate}
  \item $\KKK(A)\neq \Set{\zzero}$.
  \item $\dim(\KKK(A))>0$.
  \item $\rank(A)< n$.
  \item $\det(A)= 0$.
  \end{enumerate}
\end{cor}

\begin{remark}
  どのような$A$に対しても,
  $\zzero\in\KKK(A)$であるので,
  $\zzero$を$A\xx=\zzero$の非自明な解と呼ぶ.
\end{remark}


$A$を$(m,n)$-行列とし, $\bb$を$m$-項列ベクトルとする.
$n$個の未知数
\begin{align*}
  \xx=\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}
\end{align*}
に関する方程式
\begin{align*}
  A\xx=\bb
\end{align*}
を連立一次方程式と呼んだ.
$A$を連立一次方程式の係数行列と呼ぶ.
$(A|\bb)$を連立一次方程式の拡大係数行列と呼ぶ.
この方程式の解の集合を$\FFF(A,\bb)$と書くことにする.
つまり,
\begin{align*}
  \FFF(A,\bb)=\Set{\vv|A\vv=\bb}.
\end{align*}

\begin{prop}
  正則行列$P$に対し,
\begin{align*}
  \FFF(A,\bb)=\FFF(PA,P\bb).
\end{align*}
\end{prop}

\begin{prop}
  $\vv_0$が$A\vv_0=\bb$を満たすとする.
  このとき,
  \begin{align*}
    \FFF(A,\bb)=\Set{\vv_0+\vv|\vv\in \KKK(A)}.
  \end{align*}
\end{prop}
\begin{definition}
$\dim(\KKK(A))$を方程式$A\xx=\bb$の解の自由度と呼ぶ.
\end{definition}

\section{固有値}
$A$を$n$次正方行列,
$\lambda\in K$とする.
\begin{align*}
  V(A,\lambda)=\Set{\xx|A\xx=\lambda\xx}
\end{align*}
とおく.
\begin{align*}
  A\xx=\lambda\xx
  &\iff A\xx-\lambda\xx=\zzero\\
  &\iff (A-\lambda E_n)\xx=\zzero\\
\end{align*}
であるので,
\begin{align*}
  V(A,\lambda)=\KKK(A-\lambda E_n)
\end{align*}
である.
よって$V(A,\lambda)$は線型空間である.
\begin{definition}
$\dim(V(A,\lambda))>0$のとき,
$\lambda$を$A$の固有値と呼ぶ.
  また$V(A,\lambda)$を
  固有値$\lambda$に属する固有空間
  と呼び,
  $\vv\in V(A,\lambda)$を,
  固有値$\lambda$に属する固有ベクトルと呼ぶ.
\end{definition}
\begin{example}
  \begin{align*}
    \begin{pmatrix}0&1\\1&0\end{pmatrix}
      \begin{pmatrix}1\\-1\end{pmatrix}
        =
      \begin{pmatrix}-1\\1\end{pmatrix}
        =
      -\begin{pmatrix}1\\-1\end{pmatrix}
  \end{align*}
  であるので,
  \begin{align*}
    \begin{pmatrix}1\\-1\end{pmatrix}
      \in
      V(\begin{pmatrix}0&1\\1&0\end{pmatrix},-1)
  \end{align*}
  である.
\end{example}
\begin{remark}
  与えられたベクトル$\xx$が$A$の固有ベクトルかどうか調べるには,
  $A\xx$を計算して$\lambda\xx$となっていることをいえば良い.

  固有ベクトルを見つけるにはどうしたらよいかについて以下では考える.
  $A$の固有値$\lambda$を探すということは,
  $\dim(V(A,\lambda))>0$となる$\lambda$を探すということである.
  つまり
  $\dim(\KKK(A-\lambda E_n))>0$となる$\lambda$を探すということである.
  これは
  $\det(A-\lambda E_n)=0$となる$\lambda$を探せばよい.
  したがって, $\lambda$に関する方程式
  $\det(A-\lambda E_n)=0$を解くことで固有値が求められる.
  
  $\lambda_1,\ldots,\lambda_n$が$A$の固有値であるときに,
  $V(A,\lambda_i)$を決定するには,
  $(A-\lambda_i)\xx=\zzero$という$\xx$に関する方程式の解を求めれば良い.
\end{remark}

\begin{prop}
  $A$を$n$次正方行列とし,
  $\det(A-\lambda E_n)=0$の解を (重複度を込めて)
  $\lambda_1,\ldots,\lambda_n$とする.
  \begin{enumerate}
    \item $\tr(A)=\lambda_1+\cdots+\lambda_n$.
    \item $\det(A)=\lambda_1\cdots\lambda_n$.
    \item 次が同値:
      \begin{enumerate}
      \item $A$が正則.
      \item 0は$A$の固有値ではない.
      \end{enumerate}
  \end{enumerate}
\end{prop}

\begin{prop}
  $A$を$n$次正方行列とする.
  \begin{enumerate}
    \item $\lambda\neq\lambda'\implies V(A,\lambda)\cap V(A,\lambda')=\Set{\zzero}$.
    \item $\lambda\neq\lambda', \vv \in V(A,\lambda),\ww\in V(A,\lambda')\implies (\vv,\ww)$は一次独立.
    \item $n$個の異なる固有値をもつなら, 固有値$\lambda$に対し, $\dim(V(A,\lambda))=1$.
    \item $\lambda$が, $\det(A-\lambda E_n)=0$の$m$重根ならば,
      $1\leq \dim(V(A,\lambda))\leq m$.
  \end{enumerate}
  
\end{prop}


\section{正方行列の対角化}
\begin{definition}
  $A$を$n$次正方行列とする.
  次の条件を満たすとき,
  $A$は$P$で対角化できるという:
  \begin{enumerate}
  \item 次の条件を満たす正則行列$P$と$\lambda_1,\ldots, \lambda_n\in K$が存在する:
    \begin{align*}
      P^{-1}AP=\diag(\lambda_1,\ldots,\lambda_n).
    \end{align*}
  \end{enumerate}
\end{definition}
\begin{problem}
    どんな正方行列なら対角化できるのか?
\end{problem}
\begin{problem}
  対角化可能な行列$A$に対し,
  どうやって$P$と$\lambda_1,\ldots,\lambda_n$を見つけるか?
\end{problem}
\begin{prop}
  $A$を$n$次正方行列とし,
    $\lambda_1,\ldots, \lambda_n\in K$とする.
    このとき, 以下は同値.
    \begin{enumerate}
    \item
      \label{diagonalizable:item:1}
      $P$が以下を満たす:
      \begin{enumerate}
      \item $P$は正則.
      \item $P^{-1}AP=\diag(\lambda_1,\ldots,\lambda_n)$.
      \end{enumerate}
    \item $P=(\xx_1|\cdots|\xx_n)$とすると, 以下の条件を満たす:
      \label{diagonalizable:item:2}
      \begin{enumerate}
      \item $(\xx_1,\ldots,\xx_n)$は一次独立.
      \item $\xx_i$は固有値$\lambda_i$に属する$A$の固有ベクトル.
      \end{enumerate}
    \end{enumerate}
\end{prop}
\begin{proof}
  \paragraph{\Cref{diagonalizable:item:1}$\implies$\Cref{diagonalizable:item:2}}
  $P=(\xx_1|\cdots|\xx_n)$とする.
  $P^{-1}AP=\diag(\lambda_1,\ldots,\lambda_n)$であるので,
  $AP=P\diag(\lambda_1,\ldots,\lambda_n)$.
  一方,
  \begin{align*}
    AP&=A(\xx_1|\cdots|\xx_n)=(A\xx_1|\cdots|A\xx_n),\\
    P\diag(\lambda_1,\ldots,\lambda_n)&=(\xx_1|\cdots|\xx_n)\diag(\lambda_1,\ldots,\lambda_n)=
    (\lambda_1\xx_1|\cdots|\lambda_n\xx_n).
  \end{align*}
  したがって, $A\xx_i=\lambda_i$.

  \paragraph{\Cref{diagonalizable:item:2}$\implies$\Cref{diagonalizable:item:1}}
  $(\xx_1,\ldots,\xx_n)$は一次独立であるので,
  $P=(\xx_1|\cdots|\xx_n)$は正則である.
  また,
  \begin{align*}
    AP&=A(\xx_1|\cdots|\xx_n)\\
    &=(A\xx_1|\cdots|A\xx_n)\\
    &=(\lambda_1\xx_1|\cdots|\lambda_n\xx_n)\\
    &=(\xx_1|\cdots|\xx_n)\diag(\lambda_1,\ldots,\lambda_n)\\
    &=P\diag(\lambda_1,\ldots,\lambda_n).
  \end{align*}
  であるので,
  $P^{-1}AP=\diag(\lambda_1,\ldots,\lambda_n)$.
\end{proof}
\begin{remark}
固有ベクトルによって対角化可能性がわかる.
\end{remark}

\begin{prop}
  $A$を$n$次正方行列とし,
  $\det(A-\lambda E_n)=\prod_{i=1}^l(x-\lambda_i)^{m_i}$とする.
  このとき, 以下は同値:
  \begin{enumerate}
  \item
    $A$は対角化可能.
  \item
    $n$個の1次独立な$A$の固有ベクトルが存在する.
  \item
    $\CC^n=V(A,\lambda_1)\oplus\cdots\oplus V(A,\lambda_l)$.
  \item
    すべての$i$で, $\dim(V(A,\lambda_i))=m_i$.
  \item
    $\rank(A-\lambda_i E_n)=n=m_i$
  \end{enumerate}
\end{prop}


特別な正方行列のクラスは対角化可能であることがすぐわかる.
\begin{example}
  $n$個の異なる固有値をもつ$n$次正方行列は, 対角化可能である.
\end{example}
\begin{example}
  $n$次実対称行列は, 固有値は実数である.
  また,
  成分が実数である$n$個の固有ベクトルを互いに直交するようにとれる.
  したがって,
  直交行列で対角化可能である.
  対角化に使う直交行列は, 一旦$n$固有ベクトルを求めてから,
  Gram--Schumidtの直交化法により直交化することで求めることができる.
\end{example}

\begin{remark}
  $A$が対角化可能なら得られる対角行列は成分の並び替えを除いてただ一つである.

  この事実は次のように考えることもできる:
  $n$-次正方行列全体を考え,
  正則行列$P$に対して$P^{-1}AP\sim A$とする同値関係を考える.
  このとき,
  対角化可能な行列$A$を含む同値類の代表元として
  $A$を対角化した行列をとることができる.
  ただし, 一般には対角化はできないことに注意が必要である.
  今は, $n$-次正方行列全体を考えたが,
  対角化可能な行列の集合にこの同値関係を制限して考えれば,
  対角行列を使って完全代表系を与えることができる.
  例えば, $n$次実対称行列全体を考えたときには,
  実数を成分とする対角行列で値が大きい順に並んだもの全体$\Set{\diag(\lambda_1,\ldots,\lambda_n)|\lambda_1\geq\cdots\geq\lambda_n\in \RR}$
  が完全代表系になる.
\end{remark}

\begin{remark}
  対角化できると, $A^k$を計算するのに次の様に計算することができる:
  \begin{align*}
    P^{-1}A^kP&=P^{-1}\underbrace{A\cdots A}_{k}P\\
    &=\underbrace{(P^{-1}AP)\cdots (P^{-1}AP)}_{k}\\
    &=(P^{-1}AP)^k\\
    &=(\diag(\lambda_1,\ldots,\lambda_n))^k\\
    &=\diag(\lambda_1^k,\ldots,\lambda_n^k)
  \end{align*}
  であるので, $A^k=P\diag(\lambda_1^k,\ldots,\lambda_n^k)P^{-1}$.
\end{remark}

\section{Jordan標準形}
$A$を正方行列とする.
$A$は対角化できるときもあれば,
できないときもあった.
対角化できないときでもブロック対角にはできないだろうかという
問題について考える.

\begin{definition}
  \begin{align*}
    J_n(\alpha)=\alpha E_n+\sum_{i=1}^{n-1}B_{n,n}(i,i+1)
  \end{align*}
  をサイズ$n$, 固有値$\alpha$のJordan cellと呼ぶ.
\end{definition}
\begin{remark}
  サイズが1の場合には, $J_1(\alpha)=\alpha E_1 = (\alpha)_{\substack{i=1\\j=1}}$という
  $(1,1)$-行列である.
\end{remark}
\begin{theorem}
  \label{thm:jordan:decomp}
  $A$を$\CC$上の正方行列とする.
  このとき次を満たす正則行列$P$と, $\alpha_1,\ldots,\alpha_l \in \CC$,
  $n_1,\ldots, n_l\in\NN$が存在する:
  \begin{align}
    P^{-1}AP=\Diag(J_{n_1}(\alpha_1),\ldots,J_{n_l}(\alpha_l)).
    \label{eq:jordan:decomp}
  \end{align}
\end{theorem}
\begin{remark}
  \Cref{thm:jordan:decomp}における
  \Cref{eq:jordan:decomp}の右辺を
  Jordan標準形と呼ぶ.
  これは,
  Jordan cells の並び替えを許してただ一つに定まる.

  この事実は次のように考えることもできる:
  $n$-次正方行列全体を考え,
  正則行列$P$に対して$P^{-1}AP\sim A$とする同値関係を考える.
  このとき,
  $A$を含む同値類の代表元として
  $A$のJordan標準形をとることができる.
  また,
  Jordan cellsを並び替えたものから一つづつ選ぶことで
  完全代表系を得ることもできる.
\end{remark}
\begin{remark}
  与えられた正方行列に対し,
  Jordan標準形を求めるアルゴリズムが存在するが,
  ここでは割愛する.
\end{remark}
\begin{remark}
  $(J_n(\alpha))^k$は割と簡単に求められる.
  よって$A^k$をJordan標準形を通して計算することができる.
\end{remark}

\chapter{ベクトル空間と線型写像}
\section{数ベクトル空間と行列}
$K$を体とする.
\begin{align*}
  K^n&=\Set{\xx|\text{$\xx$は$n$項数ベクトル}}\\
  &=\Set{\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}|x_i\in K}
\end{align*}
とおき, $n$次元数ベクトル空間と呼ぶ.

$\xx=\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}\in K^n$に対し,
\begin{align*}
  \xx=x_1\ee_1^{(n)}+\cdots+x_n\ee_n^{(n)}
\end{align*}
とかける.
また, この表記は一意的である.  つまり,
\begin{align*}
  x_1\ee_1^{(n)}+\cdots+x_n\ee_n^{(n)}
  =x'_1\ee_1^{(n)}+\cdots+x'_n\ee_n^{(n)}
  \implies x_1=x'_1,\ldots,x_n=x'_n.
\end{align*}
\begin{definition}
  以下の条件を満たすとき,
  写像$\varphi\colon K^n\to K^m$は($K$-)線型であるという:
  \begin{enumerate}
    \item $\forall \xx,\yy\in K^n$, $\varphi(\xx+yy)=\varphi(\xx)+\varphi(yy)$.
    \item $\forall \xx\in K^n$, $\forall \alpha\in K$, $\varphi(\alpha\xx)=\alpha\varphi(\xx)$.
  \end{enumerate}
\end{definition}

\begin{definition}
  線型写像$\varphi\colon K^n\to K^m$に対し,
  \begin{align*}
    \Img(\varphi)&=\Set{\varphi(\xx)|\xx\in K^n},\\
    \Ker(\varphi)&=\Set{\xx\in K^m|\varphi(\xx)=\zzero}
  \end{align*}
  とおき, それぞれ, $\varphi$の像, $\varphi$の核と呼ぶ.
\end{definition}

\begin{example}
  $\id_{K^n}\colon K^n\to K^n$は線型.
\end{example}
\begin{example}
  $A$を$(m,n)$-行列とする.
  このとき,
  \begin{align*}
    \shazo{\mu_A}
          {K^n}{K^m}
          {\xx}{A\xx}
  \end{align*}
  とおくと$\mu_A$は線型.
  また$\Ker(\mu_A)=\KKK(A)$である.
\end{example}

\begin{prop}
  $\varphi\colon K^n\to K^m$を線型写像とする.
  \begin{align*}
    \aaa_1&=\varphi(\ee_1^{(n)})\\
&\vdots\\
    \aaa_n&=\varphi(\ee_n^{(n)})\\
  \end{align*}
  とし, $A=(\aaa_1|\cdots|\aaa_n)$という$(m,n)$-行列を考える.
  このとき, $\mu_A=\varphi$.
\end{prop}
\begin{proof}
  まず$\ee_j^{(n)}$について考える.
  \begin{align*}
    \varphi(\ee_j^{(n)})&=\aaa_j,\\
    \mu_A(\ee_j^{(n)})
    &=A\ee_j^{(n)}\\
    &=\text{$A$の$j$列目}\\
    &=\aaa_j
  \end{align*}
  となるので$\varphi(\ee_j^{(n)})=\aaa_j$.

  つぎに, 一般の場合について考える.
  \begin{align*}
  \xx=x_1\ee_1^{(n)}+\cdots+x_n\ee_n^{(n)}\in K^n
  \end{align*}
  とする. このとき,
  \begin{align*}
    \varphi(\xx)&=\varphi(x_1\ee_1^{(n)}+\cdots+x_n\ee_n^{(n)})\\
    &=x_1\varphi(\ee_1^{(n)})+\cdots+x_n\varphi(\ee_n^{(n)})\\
    \mu_A(\xx)&=\mu_A(x_1\ee_1^{(n)}+\cdots+x_n\ee_n^{(n)})\\
    &=x_1\mu_A(\ee_1^{(n)})+\cdots+x_n\mu_A(\ee_n^{(n)})\\
    &=x_1\varphi(\ee_1^{(n)})+\cdots+x_n\varphi(\ee_n^{(n)})
  \end{align*}
  となる.

  したがって, $\varphi=\mu_A$.
\end{proof}

\begin{cor}
  $\varphi\colon K^n\to K^m$を線型写像とする.
  このとき, 次を満たす$(m,n)$-行列$A$がただ一つ存在する:
  \begin{align*}
    \varphi=\mu_A.
  \end{align*}
  とくに$A=(a_{i,j})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}$
  とすると,
  $a_{i,j}$は$\varphi(\ee_j^{(n)})$の第$i$成分.
\end{cor}

\begin{prop}
  $B$を$(m,n)$-行列,
  $A$を$(l,m)$-行列とする.
  このとき,
  $\mu_A\circ \mu_B=\mu_{AB}$.
  つまり次の図式が可換:
  \begin{center}
  \begin{tikzcd}
    K^n \arrow[rr,"\mu_{AB}"]\arrow[rd,"\mu_B"]&& K^l \\
    & K^m \arrow[ur,"\mu_A"]
  \end{tikzcd}.
  \end{center}
\end{prop}
\begin{proof}
  $\mu_A\circ\mu_B(\ee_j^(n))$の第$i$成分が, $AB$の$(i,j)$-成分と一致することを示せばよい.
  そのため,
  $\mu_A\circ\mu_B(\ee_j^(n))$が, $AB$の$j$列目と一致することを示す.
  \begin{align*}
    B=(\bb_1|\cdots|\bb_l)
  \end{align*}
  とする.
  $AB=(A\bb_1|\cdots|A\bb_l)$である.
  よって, $\mu_{AB}(\ee_j^{l})=A\bb_j$である.
  一方,
  \begin{align*}
    (\mu_A\circ \mu_B)(\ee_j^{(l)})
    &=\mu_A(B\ee_j^{l})\\
    &=\mu_A(\bb_j)\\
    &=A\bb_j.
  \end{align*} 
\end{proof}
\begin{prop}
  $\mu_{E_n}=\id_{K^n}$である.
  $A$を$n$次正方行列とすると以下が成り立つ:
  \begin{enumerate}
  \item $A$が正則であることと, $\mu_A$が全単射であることは同値.
  \item $A$が正則ならば, $\mu_{A^{-1}}=(\mu_A)^{-1}$.
  \end{enumerate}
\end{prop}
\begin{proof}
  $E_n\xx=\xx$であることから,
  $\mu_{E_n}=\id_{K^n}$は明らか.
  また, $A$を正則とすると,
  \begin{align*}
    \mu_{A^{-1}}\circ \mu_{A} &= \mu_{A^{-1}A}=\mu_{E_n}=\id\\
    \mu_{A}\circ \mu_{A^{-1}} &= \mu_{AA^{-1}}=\mu_{E_n}=\id
  \end{align*}
  となるので, $\mu_A$は全単射であり,
  $\mu_{A^{-1}}=(\mu_A)^{-1}$.
  一方, $\mu_A$を全単射とすると逆写像$(\mu_A)^{-1}$も線型である.
  したがって, $\mu_B=(\mu_A)^{-1}$をみたす$B$がとれるが,
  この$B$に対し,
   \begin{align*}
     \mu_{BA}&=\mu_{B}\circ \mu_{A}= \id=\mu_{E_n}\\
     \mu_{AB}&=\mu_{A}\circ \mu_{B}=\id =\mu_{E_n}
   \end{align*}
   となり, $AB=BA=E_n$となるので, $B$は$A$の逆行列である.
   よって$A$は正則である.
\end{proof}
\section{ベクトル空間と線型写像}

$V$の元同士の和と$K$の元によるスカラー倍が定義されている$V$を,
$K$-ベクトル空間と呼んだ.
$V$の加法に関する零元を$0_V$と書く.

\begin{example}
  $K^n$は$K$-ベクトル空間
\end{example}\begin{example}
  $K^n$は$K$-ベクトル空間
\end{example}
\begin{example}
  $\CC$は$\CC$-ベクトル空間であるが,
  $\RR$-ベクトル空間でもある.
\end{example}
\begin{definition}
  $V$, $W$を$K$-ベクトル空間とする.
  以下の条件を満たすとき,
  写像$\varphi\colon V\to W$は($K$-)線型であるという:
  \begin{enumerate}
    \item $\forall \xx,\yy\in V$, $\varphi(\xx+yy)=\varphi(\xx)+\varphi(yy)$.
    \item $\forall \xx\in V$, $\forall \alpha\in K$, $\varphi(\alpha\xx)=\alpha\varphi(\xx)$.
  \end{enumerate}
\end{definition}

\begin{definition}
  線型写像$\varphi\colon V\to W$に対し,
  \begin{align*}
    \Img(\varphi)&=\Set{\varphi(\xx)|\xx\in V},\\
    \Ker(\varphi)&=\Set{\xx\in W|\varphi(\xx)=\zzero}
  \end{align*}
  とおき, それぞれ, $\varphi$の像, $\varphi$の核と呼ぶ.
\end{definition}

\begin{example}
  $V$を$K$-ベクトル空間とする.
  $\id_V\colon V\to V$は$K$-線型である.
\end{example}

\begin{example}
  $V,W$を$K$-ベクトル空間とし,
  $\varphi\colon V\to W$は$K$-線型であるとする.
  $\varphi$が全単射であるとき,
  逆写像$\varphi^{-1}\colon W\to V$も線型.
\end{example}

\begin{example}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  \begin{align*}
    \shazo{\pi_{(v_1,\ldots,v_n)}}
          {K^n}{V}
          {\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}}{a_1v_1+\cdots+a_nv_n}
  \end{align*}
  とする.
  このとき, $\pi_{(v_1,\ldots,v_n)}$は$K$-線型である.
\end{example}

\begin{definition}
  $\varphi\colon V\to W$を$K$-線型写像とする.
  次の条件を満たすとき, $\varphi$を同型写像と呼ぶ:
  \begin{enumerate}
  \item 以下の条件を満たす線型写像$\psi\colon W\to V$が存在する:
    \begin{enumerate}
      \item $\varphi\circ \psi=\id_W$.
      \item $\psi\circ \varphi=\id_V$.
    \end{enumerate}
  \end{enumerate}
  $V$から$W$への同型写像があるとき,
  $V$と$W$は同型であるという.
\end{definition}

\begin{remark}
  $V$と$W$が同型ならば,
  $V$と$W$はベクトル空間としては同じものだと思うことができる.
\end{remark}
\begin{prop}
  $V$, $W$を$K$-ベクトル空間とし,
  $\varphi$を$V$から$W$への写像とする.
  このとき以下は同値:
  \begin{enumerate}
  \item $\varphi$は$K$-線型同型写像である.
  \item $\varphi$は$K$-線型写像であり全単射である.
  \end{enumerate}
\end{prop}
\begin{prop}
  $\varphi\colon V\to W$を$K$-線型写像とする.
  このとき, $\varphi$が単射であることと,
  $\Ker(\varphi)=\Set{0_V}$は同値である.
\end{prop}
\begin{definition}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  次の条件を満たすとき,
  $(v_1,\ldots,v_n)$は一次独立であるという:
  \begin{enumerate}
    \item $\pi_{v_1,\ldots,v_n}$が単射.
  \end{enumerate}
\end{definition}
\begin{remark}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  以下は同値である:
  \begin{enumerate}
  \item $(v_1,\ldots,v_n)$は一次独立.
  \item $\Ker(\pi_{v_1,\ldots,v_n})=\Set{\zzero}$.
  \item $a_1v_1+\cdots+a_nv_n=0_V\implies a_1=\cdots=a_n=0$.
  \end{enumerate}
\end{remark}
\begin{definition}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  次の条件を満たすとき,
  $(v_1,\ldots,v_n)$は$V$の生成系であるという:
  \begin{enumerate}
    \item $\pi_{v_1,\ldots,v_n}$が全射.
  \end{enumerate}
\end{definition}
\begin{remark}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  以下は同値である:
  \begin{enumerate}
  \item $(v_1,\ldots,v_n)$は$V$の生成系.
  \item $\Img(\pi_{v_1,\ldots,v_n})=V$.
  \item $V=\Set{a_1v_1+\cdots+a_nv_n|a_i\in K}$.
  \end{enumerate}
\end{remark}


\begin{definition}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  以下のの条件を満たすとき,
  $(v_1,\ldots,v_n)$は$V$の基底であるという:
  \begin{enumerate}
  \item $(v_1,\ldots,v_n)$は$V$の生成系.
  \item $(v_1,\ldots,v_n)$は一次独立.
  \end{enumerate}
\end{definition}
\begin{remark}
  $V$を$K$-ベクトル空間とし,
  $v_1,\ldots,v_n\in V$とする.
  以下は同値である:
  \begin{enumerate}
  \item $(v_1,\ldots,v_n)$は$V$の基底.
  \item $\pi_{v_1,\ldots,v_n}$が全単射.
  \item $\pi_{v_1,\ldots,v_n}$が同型写像.
  \end{enumerate}
\end{remark}

\begin{remark}
  $V$を$K$-ベクトル空間とし,
  $(v_1,\ldots,v_n)$を$V$の基底とする.
  このとき, $K^n$と$V$は同型である.
  $V$の次元は$n$であるといい$\dim(V)=n$と書く.
  \begin{align*}
    \shazo{\pi_{(v_1,\ldots,v_n)}}
          {K^n}{V}
          {\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}}{a_1v_1+\cdots+a_n v_n}
  \end{align*}
  は同型写像である. したがって, この逆写像
  \begin{align*}
    \shazo{\varepsilon_{(v_1,\ldots,v_n)}=(\pi_{(v_1,\ldots,v_n)})^{-1}}
          {V}{K^n}
          {a_1v_1+\cdots+a_Nv_n}{\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}}
  \end{align*}
  も同型写像である.
  $\varepsilon_{(v_1,\ldots,v_n)}(v_k)=\ee_k^{(n)}$となっている.
\end{remark}

\section{表現行列}
$V$, $W$を$K$-ベクトル空間とし,
$(v_1,\ldots,v_n)$を$V$の基底,
$(w_1,\ldots,w_m)$を$W$の基底とする.
また,
$\varphi\colon V\to W$を$K$-線型写像とする.
このとき,
\begin{align*}
  \pi^{-1}_{w_1,\ldots,w_m}\circ \varphi \circ \pi_{v_1,\ldots,v_m}
  \colon K^n\to K^m
\end{align*}
は線形写像である. 
$K^n$から$K^m$への線型写像なので
\begin{align*}
  \mu_{A}=\pi^{-1}_{w_1,\ldots,w_m}\circ \varphi \circ \pi_{v_1,\ldots,v_m}
\end{align*}
を満たす$(m,n)$行列がとれる.
図式で表すと
\begin{center}
  \begin{tikzcd}
    K^n \arrow[d,"\pi_{v_1,\ldots,v_m}"'] \arrow[r,dashed,"\mu_A"]&K^m\\
    V \arrow[r,"\varphi"] &W \arrow[u,"\pi^{-1}_{w_1,\ldots,w_m}"']
  \end{tikzcd}
\end{center}
となる.
この行列$A$を,
$\varphi$の
基底$(v_1,\ldots,v_n)$,
$(w_1,\ldots,w_m)$
に関する表現行列と呼ぶ.
\begin{remark}
表現行列$A=(a_{i,j})_{\substack{i=1,\ldots,m\\j=1,\ldots,n}}$の$(i,j)$-成分$a_{i,j}$は,
\begin{align*}
  \pi^{-1}_{w_1,\ldots,w_m}\circ \varphi \circ \pi_{v_1,\ldots,v_m}
  (\ee_j^{(n)})
\end{align*}
を$K^m$の基底$(\ee_1^{(m)},\ldots,\ee_m^{(m)})$の線型結合として書いた際の
$\ee_i^{(m)}$の係数である.
つまり,
$\varphi(v_j)$を
$W$の基底$(w_1,\ldots,w_m)$の線型結合として書いた際の
$w_i$の係数である.
\end{remark}
\begin{prop}
$V$, $W$, $U$を$K$-ベクトル空間とし,
$(v_1,\ldots,v_n)$を$V$の基底,
$(w_1,\ldots,w_m)$を$W$の基底,
$(u_1,\ldots,u_l)$を$U$の基底とする.
このとき, 線型写像
$\varphi\colon V\to W$,
$\psi\colon W\to U$について考える.
$\varphi$の
$(v_1,\ldots,v_n)$,
$(w_1,\ldots,w_m)$に関する表現行列を$A$
とし,
$\psi$の
$(w_1,\ldots,w_m)$,
$(u_1,\ldots,u_l)$に関する表現行列を$B$
とする.
このとき,
$\psi\circ \varphi$の
$(v_1,\ldots,v_n)$,
$(u_1,\ldots,u_l)$に関する表現行列は$BA$
となる.
図式で表すと
\begin{center}
  \begin{tikzcd}
    K^n \arrow[d,"\pi_{v_1,\ldots,v_m}"'] \arrow[r,dashed,"\mu_A"]&
    K^m \arrow[d,shift left,"\pi_{w_1,\ldots,w_m}"] \arrow[r,dashed,"\mu_A"]&K^l\\
    V \arrow[r,"\varphi"] &
    W \arrow[u,shift left,"\pi^{-1}_{w_1,\ldots,w_m}"] \arrow[r,"\psi"] &W \arrow[u,"\pi^{-1}_{u_1,\ldots,u_k}"']
  \end{tikzcd}
\end{center}
となる.
\end{prop}

\begin{prop}
  $A$が$\varphi$の表現行列であるとき,
  \begin{align*}
    \rank(A)=\dim(Img(\mu_A))=\dim(\Img(\varphi)).
  \end{align*}
\end{prop}

\section{基底の取り替え}
$V$を$K$-ベクトル空間とし,
$(v_1,\ldots,v_n)$,
$(v'_1,\ldots,v'_n)$
を$V$の基底とする.
このとき, $K$線型写像
\begin{align*}
\pi_{v'_1,\ldots,v'_n}^{-1}\circ \pi_{v_1,\ldots,v_n}\colon K^n\to K^n
\end{align*}
に対し,
$\mu_{P}=\pi_{v'_1,\ldots,v'_n}^{-1}\circ \pi_{v_1,\ldots,v_n}$
を満たす$n$次正方行列$P$がとれる.
図式で表すと,
\begin{center}
  \begin{tikzcd}
    K^n \arrow[rr,dashed,"\mu_{P}"]\arrow[rd,"\pi_{v_1,\ldots,v_n}"']&& K^n \\
    & K^m \arrow[ur,"\pi_{v'_1,\ldots,v'_n}^{-1}"']
  \end{tikzcd}
\end{center}
となる.
$\pi_{v'_1,\ldots,v'_n}^{-1}\circ \pi_{v_1,\ldots,v_n}$は全単射なので,
$P$は正則.
$P$を
$(v_1,\ldots,v_n)$から
$(v'_1,\ldots,v'_n)$への
基底の変換行列と呼ぶ.


基底を取り替えたとき表現行列がとうなるかは,
基底の変換行列により記述できる.
\begin{prop}
$V$を$K$-ベクトル空間とし,
$(v_1,\ldots,v_n)$,
$(v'_1,\ldots,v'_n)$
を$V$の基底とする.
$(v_1,\ldots,v_n)$から
$(v'_1,\ldots,v'_n)$への基底の変換行列を$P$とする.
また,
$W$を$K$-ベクトル空間とし,
$(w_1,\ldots,w_m)$,
$(w'_1,\ldots,w'_m)$
を$W$の基底とする.
$(w_1,\ldots,w_m)$から
$(w'_1,\ldots,w'_m)$への基底の変換行列を$Q$とする.
$\varphi\colon V\to W$を線型写像とし,
$(v_1,\ldots,v_n)$,
$(w_1,\ldots,w_m)$
に関する
$\varphi$の表現行列を$A$とし,
$(v'_1,\ldots,v'_n)$
$(w'_1,\ldots,w'_m)$
に関する
$\varphi$の表現行列を$A'$とする.
このとき,
\begin{align*}
\mu_{A'}=\mu_Q\circ \mu_A \circ \mu_{P^{-1}}
\end{align*}
となるので,
\begin{align*}
  A'&=Q A P^{-1}
\end{align*}
となる.
図式で表すと
\begin{center}
  \begin{tikzcd}
    K^n \arrow[rrr,"\mu_{A}"]\arrow[rd,"\pi_{v_1,\ldots,v_n}"]\arrow[dd,"\mu_{P}"']&&& K^n\arrow[dd,"\mu_{Q}"] \\
    & V \arrow[r,"\varphi"']&W\arrow[rd,"\pi_{v'_1,\ldots,v'_n}^{-1}"']\arrow[ru,"\pi_{v_1,\ldots,v_n}^{-1}"]&\\
    K^n \arrow[rrr,"\mu_{A'}"']\arrow[ru,"\pi_{v'_1,\ldots,v'_n}"']&&& K^n 
  \end{tikzcd}
\end{center}
となる.
\end{prop}

\section{直和}

$n$次元ベクトル空間$V$と,
$m$次元ベクトル空間$W$から
$n+m$次元ベクトル空間を作ることを考える.
例えば,
\begin{align*}
  K^n&=\Set{\xx=\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}|x_i\in K}\\
  K^m&=\Set{\yy=\begin{pmatrix}y_1\\\vdots\\y_m\end{pmatrix}|y_i\in K}
\end{align*}
に対して,
\begin{align*}
  K^{n+m}
  &=\Set{\begin{pmatrix}\xx\\\hline\yy\end{pmatrix}|\xx\in K^n,\yy\in K^m}\\
  &=\Set{\begin{pmatrix}x_1\\\vdots\\x_n\\y_1\\\vdots\\y_m\end{pmatrix}|x_i,y_i\in K}
\end{align*}
を作るといようなことを行いたい.

\subsection{内部直和}

$U$を$K$ベクトル空間とし,
$V,W\subset U$とする.
また$V$, $W$も($U$と同じ演算で)$K$ベクトル空間となっているとする.
このようなとき, $V$と$W$は$U$の部分空間であるという.
このとき,
$V$と$W$の
\begin{align*}
  V+W&=\Set{v+w|v\in V, w\in W}\\
  V\cap W&=\Set{v|v\in V\text{ かつ }w\in W}
\end{align*}
とおく.
このとき, $V+W$も$V\cap W$も$K$ベクトル空間.
一般に
\begin{align*}
  \dim(V+W)=\dim(V)+\dim(W)-\dim(V\cap W)
\end{align*}
である.
したがって,
\begin{align*}
  \dim(V+W)\leq \dim(V)+\dim(W)
\end{align*}
であり,
\begin{align*}
  V\cap W=\Set{0_U}\iff \dim(V+W)=\dim(V)+\dim(W)
\end{align*}
である.
\begin{definition}
  $V\cap W=\Set{0_U}$であるとき,
  $V+W$を$V$と$W$の(内部)直和と呼び,
  $V\oplus W$と書く.  
\end{definition}
\begin{prop}
  $V$, $W$を$U$の部分空間とし,
  $V\cap W=\Set{0_U}$であるとする.
  $(v_1,\ldots,v_n)$を$V$の基底,
  $(w_1,\ldots,w_m)$を$W$の基底とすると,
  $(v_1,\ldots,v_n,w_1,\ldots,w_m)$は
  $V\oplus W$の基底である.
\end{prop}



\subsection{外部直和}


$V,W$を$K$ベクトル空間とし,
\begin{align*}
  X&=\Set{(v,w)|v\in V,w\in W}
\end{align*}
は,
\begin{align*}
  (v,w)+(v',w')&=(v+v',w+w')\\
  \alpha(v,w)&=(\alpha v,\alpha w)
\end{align*}
という和とスカラー倍でベクトル空間となる.
またその次元は, $\dim(V)$と$\dim(W)$である.
このベクトル空間を$V$と$U$の(外部)直和と呼び,
$V\oplus W$で表す.

\begin{prop}
  $V$, $W$を$U$の部分空間とし,
  $V\cap W=\Set{0_V}$であるとする.
  $V$と$W$の外部直和を$X$,
  $V$と$W$の内部直和を$Y$とする.
  このとき,
  \begin{align*}
    \shazo{\varphi}
          {X}{Y}
          {(v,w)}{v+w}
  \end{align*}
  は同型写像である.
\end{prop}

\begin{prop}
  $V$, $W$を$K$ベクトル空間とし,
  $(v_1,\ldots,v_n)$を$V$の基底,
  $(w_1,\ldots,w_m)$を$W$の基底とする.
  このとき,
  $((v_1,0_W),\ldots,(v_n,0_W),(0_V,w_1),\ldots,(0_V,w_1))$は
  外部直和$V\oplus W$の基底である.
\end{prop}


\subsection{写像の直和}
線型写像
$\varphi\colon V\to W$,
$\varphi'\colon V'\to W'$,
が与えられたとき,
\begin{align*}
  \shazo{\varphi\oplus\varphi'}
        {V\oplus V'}{W\oplus W'}
        {(v,v')}{\varphi(v)+\varphi'(v')}
\end{align*}
とおき, $\varphi$と$\varphi'$の直和と呼ぶ.
$\varphi\oplus\varphi'$は線型写像である.


$(v_1,\ldots,v_n)$を$V$の基底,
$(v'_1,\ldots,v'_{n'})$を$V'$の基底とする.
このとき,
$\hat v_i=(v_i,0_{V'})$,
$\check v'_i=(0_V,v'_i)$とおけば,
$(\hat v_1,\ldots,\hat v_n,\check v'_1,\ldots, \check v'_{n'})$
は$V\oplus V'$の基底である.
同様に,
$(w_1,\ldots,w_m)$を$W$の基底,
$(w'_1,\ldots,w'_{m'})$を$W'$の基底
とする.
このとき,
$\hat w_i=(w_i,0_{W'})$,
$\check w'_i=(0_W,w'_i)$とおけば,
$(\hat w_1,\ldots,\hat w_m,\check w'_1,\ldots, \check w'_{m'})$
は$W\oplus W'$の基底である.
また,
$(v_1,\ldots,v_n)$,
$(w_1,\ldots,w_m)$
に関する
線型写像$\varphi$の表現行列を$A$とし,
$(v'_1,\ldots,v'_{n'})$
$(w'_1,\ldots,w'_{m'})$
に関する
線型写像$\varphi'$の表現行列を$A'$とする.
このとき,
線型写像$\varphi\oplus\varphi'$の
$(\hat v_1,\ldots,\hat v_n,\check v'_1,\ldots, \check v'_{n'})$,
$(\hat w_1,\ldots,\hat w_m,\check w'_1,\ldots, \check w'_{m'})$
に関する表現行列は
\begin{align*}
  \Diag(A,A')
\end{align*}
となる.
$\Diag(A,A')$を$A\oplus A'$と書くこともある.

\chapter{ここまでのまとめ}
\section{行列の変形と標準形}

$PA=B$を満たす正則行列$P$が存在するとき,
$A\sim B$とする.
このとき$\sim$は同値関係である.
$(m,n)$行列$A$に対し,
$A\sim S$を満たす被約行階段行列$S$がただ一つ存在する.
つまり,
\begin{align*}
  \Set{A\text{: $(m,n)$行列}}/\sim
\end{align*}
の完全代表系として,
\begin{align*}
  \Set{S\text{: $(m,n)$-被約行階段行列}}
\end{align*}
を取れる.

$AP=B$を満たす正則行列$P$が存在するとき,
$A\sim B$とする.
このとき$\sim$は同値関係である.
$(m,n)$行列$A$に対し,
$A\sim S$を満たす被約列階段行列$S$がただ一つ存在する.
つまり,
\begin{align*}
  \Set{A\text{: $(m,n)$行列}}/\sim
\end{align*}
の完全代表系として,
\begin{align*}
  \Set{S\text{: $(m,n)$-被約列階段行列}}
\end{align*}
を取れる.

$QAP=B$を満たす正則行列$P$, $Q$が存在するとき,
$A\sim B$とする.
このとき$\sim$は同値関係である.
$(m,n)$行列$A$に対し,
$A\sim S$を満たす階数標準形がただ一つ存在する.
つまり,
\begin{align*}
  \Set{A\text{: $(m,n)$行列}}/\sim
\end{align*}
の完全代表系として,
\begin{align*}
  \Set{\left(\begin{array}{c|c}E_r&O_{r,n-r}\\\hline O_{m-r,r}&O_{m-r,n-r}\end{array}\right)
    |r\in\Set{0,1,\ldots,\min(m,n)}}
\end{align*}
を取れる.
$r$が動く範囲は有限なので有限集合である.
階数標準形
\begin{align*}
  \left(\begin{array}{c|c}E_r&O_{r,n-r}\\\hline O_{m-r,r}&O_{m-r,n-r}\end{array}\right)
\end{align*}
は,
\begin{align*}
  E_r\oplus O_{m-r,n-r}=\underbrace{E_1\oplus \cdots \oplus E_1}_{n}\oplus O_{m-r,n-r}
\end{align*}
と書くこともできる.

$P^{-1}AP=B$を満たす正則行列$P$が存在するとき,
$A\sim B$とする.
このとき$\sim$は同値関係である.
$A$が対角化可能であるとすると,
$\diag(\lambda_1,\ldots,\lambda_n)\sim A$
を満たす$\lambda_1,\ldots,\lambda_n$がとれる.
$\lambda_1,\ldots,\lambda_n$は並び替えを除いてただひと組存在する.
例えば,
考える行列として実対称行列のみを考えるならば
\begin{align*}
  \Set{A\text{: $n$次実対称行列}}/\sim
\end{align*}
の完全代表系として,
\begin{align*}
  \Set{\diag(\lambda_1,\ldots,\lambda_n)|\lambda_1\geq \cdots\geq \lambda_n\in \RR}/\sim
\end{align*}
が取れる.
より一般には,
$A$を$n$次正方行列とすると,
$A=J(n_1,\lambda_1)\oplus\cdots\oplus J(n_l,\lambda_l)$
をみたす$(n_1,\lambda_1),\ldots,(n_l,\lambda_l)$
が存在する.
これらは, 並び替えを除いてただ一組存在する.
\begin{align*}
  \Set{A\text{: $n$次正方行列}}/\sim
\end{align*}
の完全代表系として,
\begin{align*}
\Set{J(n_1,\lambda_1)\oplus\cdots\oplus J(n_l,\lambda_l)|\lambda_i\in \RR,n_i\in\ZZ_{>0},n_1+\cdots+n_l=n}
\end{align*}
の部分集合をとれる.
固有値が異なると異なる同値類となるので,
無限個の代表が必要となる.

\section{}
$A$を$(m,n)$行列とし,
\begin{align*}
  \shazo{\mu_A}
        {K^n}{K^m}
        {\xx}{A\xx}
\end{align*}
とおくと$\varphi_A$は線形写像である.
また, 与えられた線型写像$\varphi\colon K^n\to K^m$に対し,
$\varpi=\mu_A$を満たす$A$がただ一つ定まる.
$V$をベクトル空間とし,
$(v_1,\ldots,v_n)$を$V$の基底とする.
\begin{align*}
  \shazo{\pi_{(v_1,\ldots,v_n)}}
        {K^n}{V}
        {\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}}{a_1v_1+\cdots+a_nv_n}
\end{align*}
とおく.
$(v_1,\ldots,v_n)$を$V$の基底であることと,
$\pi_{(v_1,\ldots,v_n)}$が全単射であることは同値であるので,
$\varepsilon_{(v_1,\ldots,v_n)}$を
$\pi_{(v_1,\ldots,v_n)}$の逆写像として定義する.
つまり
\begin{align*}
  \shazo{\varepsilon_{(v_1,\ldots,v_n)}}
        {V}{K^n}
        {a_1v_1+\cdots+a_Nv_n}{\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}}
\end{align*}
とおく.

$V$を$K$-ベクトル空間とし,
$(v_1,\ldots,v_n)$,
$(v'_1,\ldots,v'_n)$
を$V$の基底とする.
このとき, 図式
\begin{center}
  \begin{tikzcd}
    K^n \arrow[rr,dashed,"\mu_{P}"]\arrow[rd,"\pi_{v_1,\ldots,v_n}"']&& K^n \\
    & K^m \arrow[ur,"\pi_{v'_1,\ldots,v'_n}^{-1}"']
  \end{tikzcd}
\end{center}
を可換にする正則$P$が存在する.
この$P$を
$(v_1,\ldots,v_n)$から
$(v'_1,\ldots,v'_n)$への基底の変換行列と呼んだ.

$\varphi\colon V\to W$を線型写像とし,
$(v_1,\ldots,v_n)$
を$V$の基底とし,
$(w_1,\ldots,w_m)$
を$W$の基底とする.
このとき, 図式
\begin{center}
  \begin{tikzcd}
    K^n \arrow[d,"\pi_{v_1,\ldots,v_m}"'] \arrow[r,dashed,"\mu_A"]&K^m\\
    V \arrow[r,"\varphi"] &W \arrow[u,"\varepsilon_{w_1,\ldots,w_m}"']
  \end{tikzcd}
\end{center}
を可換にする行列$A$ただ一つ存在する.
この行列$A$を,
$(v_1,\ldots,v_n)$,
$(w_1,\ldots,w_m)$
に関する$\varphi$の表現行列と呼んだ.

線型写像
$\varphi\colon V\to W$
に対し,
\begin{align*}
  [\varphi]=
  \Set{A|\begin{array}{c}
\text{$(v_1,\ldots,v_n)$: $V$の基底}\\
\text{$(w_1,\ldots,w_m)$: $W$の基底}\\
\text{$(v_1,\ldots,v_n)$, $(w_1,\ldots,w_m)$に関する$\varphi$の表現行列}
  \end{array}}
\end{align*}
とおく.
このとき, $[\varphi]$はどのような集合か考えてみる.
$(v_1,\ldots,v_n)$,
$(v'_1,\ldots,v'_n)$
を$V$の基底とし,
$(v_1,\ldots,v_n)$から
$(v'_1,\ldots,v'_n)$への基底の変換行列を$P$とする.
また,
$(w_1,\ldots,w_m)$,
$(w'_1,\ldots,w'_m)$
を$W$の基底とし
$(w_1,\ldots,w_m)$から
$(w'_1,\ldots,w'_m)$への基底の変換行列を$Q$とする.
$(v_1,\ldots,v_n)$,
$(w_1,\ldots,w_m)$
に関する
$\varphi$の表現行列を$A$とし,
$(v'_1,\ldots,v'_n)$
$(w'_1,\ldots,w'_m)$
に関する
$\varphi$の表現行列を$A'$とする.
このとき,
図式
\begin{center}
  \begin{tikzcd}
    K^n \arrow[rrr,"\mu_{A}"]\arrow[rd,"\pi_{v_1,\ldots,v_n}"]\arrow[dd,"\mu_{P}"']&&& K^n\arrow[dd,"\mu_{Q}"] \\
    & V \arrow[r,"\varphi"']&W\arrow[rd,"\varepsilon_{v'_1,\ldots,v'_n}"']\arrow[ru,"\varepsilon_{v_1,\ldots,v_n}^{-1}"]&\\
    K^n \arrow[rrr,"\mu_{A'}"']\arrow[ru,"\pi_{v'_1,\ldots,v'_n}"']&&& K^n 
  \end{tikzcd}
\end{center}
が可換となるので, $B=PAQ^{-1}$と書けることがわかる.
したがって
$A$が$\varphi$のある基底に関する表現行列であるとすると,
\begin{align*}
  [\varphi]=\Set{PAQ|\text{$P$, $Q$:正則行列}}
\end{align*}
である.
$A,B\in [\varphi]$となるとき,
$A\sim B$とすると, $\sim$は同値関係である.
\begin{align*}
  \Set{A\text{: $(m,n)$行列}}/\sim
\end{align*}
の完全代表系として,
\begin{align*}
  \Set{E_r\oplus O_{m-r,n-r}|r\in\Set{0,1,\ldots,\min(m,n)}}
\end{align*}
がとれる.
